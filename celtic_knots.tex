\documentclass{article}
\usepackage{tikz}
\usepackage{expl3}
\usepackage{xparse}

\ExplSyntaxOn

\cs_new_nopar:Npn \celtic_set_crossing:nnn #1#2#3
{
  \tl_set:cn {crossing \int_eval:n {#1} - \int_eval:n{#2}}{#3}
}

\int_new:N \l__celtic_width_int
\int_new:N \l__celtic_height_int

\DeclareDocumentCommand \CelticSetSymmetricCrossing {m m m}
{
  \celtic_set_crossing:nnn {#1}{#2}{#3}
  \celtic_set_crossing:nnn {\l__celtic_width_int - #1}{#2}{#3}
  \celtic_set_crossing:nnn {#1}{\l__celtic_height_int - #2}{#3}
  \celtic_set_crossing:nnn {\l__celtic_width_int - #1}{\l__celtic_height_int - #2}{#3}
}

\DeclareDocumentCommand \CelticSetCrossing {m m m}
{
  \celtic_set_crossing:nnn {#1}{#2}{#3}
}

\DeclareDocumentCommand \CelticSetSize {m m}
{
  \int_set:Nn \l__celtic_width_int {#1}
  \int_set:Nn \l__celtic_height_int {#2}
}

\cs_generate_variant:Nn \tl_if_eq:nnTF {vnTF}

\DeclareDocumentCommand \CelticCheckCrossing {m m m m}
{
  \tl_if_exist:cT {crossing \int_eval:n {#1} - \int_eval:n {#2}}
  {
    \tl_if_eq:vnTF {crossing \int_eval:n {#1} - \int_eval:n {#2}} {|}
    {
      #3
    }
    {
      #4
    }
  }
}

\int_new:N \l__celtic_x
\int_new:N \l__celtic_y
\int_new:N \l__celtic_dx
\int_new:N \l__celtic_dy
\int_new:N \l__celtic_ox
\int_new:N \l__celtic_oy
\int_new:N \l__celtic_lout
\tl_new:N \l__celtic_path_tl
\int_new:N \l__celtic_cross_int
\bool_new:N \l__celtic_bounce_bool
\bool_new:N \l__celtic_pbounce_bool

\cs_new_nopar:Npn \celtic_next_crossing:
{
  \int_zero:N \l__celtic_cross_int
  \tl_clear:N \l__celtic_crossing_tl
  \tl_clear:N \l__celtic_path_tl
  \tl_put_right:Nx \l__celtic_path_tl {(\int_use:N \l__celtic_x, \int_use:N \l__celtic_y)}
  \int_set:Nn \l__celtic_lout {(90 - \l__celtic_dx * 45) * \l__celtic_dy}

  \bool_do_until:nn {\int_compare_p:n {\l__celtic_cross_int > 1}}
  {
    \bool_set_eq:NN \l__celtic_pbounce_bool \l__celtic_bounce_bool
    \bool_set_false:N \l__celtic_bounce_bool
    
    \int_add:Nn \l__celtic_x {\l__celtic_dx}
    \int_add:Nn \l__celtic_y {\l__celtic_dy}

    \tl_if_exist:cT {crossing \int_use:N \l__celtic_x - \int_use:N       \l__celtic_y}
    {
      \tl_if_eq:vnTF {crossing \int_use:N \l__celtic_x - \int_use:N \l__celtic_y} {|}
      {
        \bool_if:NTF \l__celtic_pbounce_bool
        {
          \tl_put_right:Nn \l__celtic_path_tl { -| }
        }
        {
          \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_eval:n
{(90 - 45*\l__celtic_dx)*\l__celtic_dy}, in=\int_eval:n
{-90*\l__celtic_dy}] }
        }
        \int_set:Nn \l__celtic_lout {90*\l__celtic_dy}
        \int_set:Nn \l__celtic_dx {-\l__celtic_dx}
        \tl_put_right:Nx  \l__celtic_path_tl {(\fp_eval:n           {\int_use:N \l__celtic_x + .5 * \int_use:N \l__celtic_dx}, \int_use:N \l__celtic_y)}
        \bool_set_true:N \l__celtic_bounce_bool
      }
      {
        \bool_if:NTF \l__celtic_pbounce_bool
        {
          \tl_put_right:Nn \l__celtic_path_tl { |- }
        }
        {
          \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_eval:n {(90 - 45*\l__celtic_dx)*\l__celtic_dy}, in=\int_eval:n {90 + 90*\l__celtic_dx}] }
        }
        \int_set:Nn \l__celtic_lout {90-90*\l__celtic_dx}
        \int_set:Nn \l__celtic_dy {-\l__celtic_dy}
        \tl_put_right:Nx \l__celtic_path_tl {(\int_use:N \l__celtic_x, \fp_eval:n {\int_use:N \l__celtic_y + .5 * \int_use:N \l__celtic_dy})}
        \bool_set_true:N \l__celtic_bounce_bool
      }
    }
    \int_compare:nT {\l__celtic_x == 0}
    {
      \bool_if:NTF \l__celtic_pbounce_bool
      {
        \tl_put_right:Nn \l__celtic_path_tl { -| }
      }
      {
        \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_eval:n {(90 - 45*\l__celtic_dx)*\l__celtic_dy}, in=\int_eval:n {-90*\l__celtic_dy}] }
      }
      \int_set:Nn \l__celtic_lout {90*\l__celtic_dy}
      \int_set:Nn \l__celtic_dx {-\l__celtic_dx}
      \tl_put_right:Nx  \l__celtic_path_tl {(\fp_eval:n {\int_use:N \l__celtic_x + .5 * \int_use:N \l__celtic_dx}, \int_use:N \l__celtic_y)}
      \bool_set_true:N \l__celtic_bounce_bool
    }
    \int_compare:nT {\l__celtic_x == \l__celtic_width_int}
    {
      \bool_if:NTF \l__celtic_pbounce_bool
      {
        \tl_put_right:Nn \l__celtic_path_tl { -| }
      }
      {
        \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_eval:n {(90 - 45*\l__celtic_dx)*\l__celtic_dy}, in=\int_eval:n {-90*\l__celtic_dy}] }
      }
      \int_set:Nn \l__celtic_lout {90*\l__celtic_dy}
      \int_set:Nn \l__celtic_dx {-\l__celtic_dx}
      \tl_put_right:Nx \l__celtic_path_tl {(\fp_eval:n {\int_use:N \l__celtic_x + .5 * \int_use:N \l__celtic_dx}, \int_use:N \l__celtic_y)}
      \bool_set_true:N \l__celtic_bounce_bool
    }
    \int_compare:nT {\l__celtic_y == 0}
    {
      \bool_if:NTF \l__celtic_pbounce_bool
      {
        \tl_put_right:Nn \l__celtic_path_tl { |- }
      }
      {
        \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_eval:n {(90 - 45*\l__celtic_dx)*\l__celtic_dy}, in=\int_eval:n {90 + 90*\l__celtic_dx}] }
      }
      \int_set:Nn \l__celtic_lout {90-90*\l__celtic_dx}
      \int_set:Nn \l__celtic_dy {-\l__celtic_dy}
      \tl_put_right:Nx \l__celtic_path_tl {(\int_use:N \l__celtic_x, \fp_eval:n {\int_use:N \l__celtic_y + .5 * \int_use:N \l__celtic_dy})}
      \bool_set_true:N \l__celtic_bounce_bool
    }
    \int_compare:nT {\l__celtic_y == \l__celtic_height_int}
    {
      \bool_if:NTF \l__celtic_pbounce_bool
      {
        \tl_put_right:Nn \l__celtic_path_tl { |- }
      }
      {
        \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_eval:n {(90 - 45*\l__celtic_dx)*\l__celtic_dy}, in=\int_eval:n {90 + 90*\l__celtic_dx}] }
      }
      \int_set:Nn \l__celtic_lout {-90+90*\l__celtic_dx}
      \int_set:Nn \l__celtic_dy {-\l__celtic_dy}
      \tl_put_right:Nx \l__celtic_path_tl {(\int_use:N \l__celtic_x, \fp_eval:n {\int_use:N \l__celtic_y + .5 * \int_use:N \l__celtic_dy})}
      \bool_set_true:N \l__celtic_bounce_bool
    }

    \bool_if:NF \l__celtic_bounce_bool
    {
      \bool_if:NTF \l__celtic_pbounce_bool
      {
        \tl_put_right:Nx \l__celtic_path_tl { to[out=\int_use:N \l__celtic_lout,in=\int_eval:n {(-90 - 45 * \l__celtic_dx)*\l__celtic_dy}] }
      }
      {
        \tl_put_right:Nn \l__celtic_path_tl { -- }
      }
      \tl_put_right:Nx  \l__celtic_path_tl { (\int_use:N         \l__celtic_x, \int_use:N \l__celtic_y)}
      \tl_if_empty:NTF \l__celtic_crossing_tl
      {
        \tl_set:Nx \l__celtic_crossing_tl {(\int_use:N         \l__celtic_x, \int_use:N \l__celtic_y)}
      }
      {
        \tl_clear:c {crossing used \int_use:N \l__celtic_x - \int_use:N \l__celtic_y}
      }
      \int_incr:N \l__celtic_cross_int
      \int_set:Nn \l__celtic_lout {(90 - \l__celtic_dx * 45) * \l__celtic_dy}
    }
  }
}

\int_new:N \l__celtic_int
\int_new:N \l__celtic_flip_int
\seq_new:N \l__celtic_path_seq
\seq_new:N \l__celtic_crossing_seq

\cs_generate_variant:Nn \tl_if_single_p:N {c}
\cs_generate_variant:Nn \tl_if_single:NTF {cTF}
\cs_generate_variant:Nn \tl_if_eq:nnTF {xnTF}
\cs_generate_variant:Nn \tl_head:N {c}
\cs_generate_variant:Nn \tl_tail:N {c}

\bool_new:N \l__celtic_repeat_bool

\DeclareDocumentCommand \CelticDrawPath {s O{}}
{
  \bool_set_false:N  \l__celtic_repeat_bool
  \seq_clear:N \l__celtic_path_seq
  \seq_clear:N \l__celtic_crossing_seq

% Clear all crossings
  \int_step_inline:nnnn {1} {1} {\l__celtic_height_int-1}
  {
    \int_step_inline:nnnn {1 + \int_mod:nn {##1}{2}} {2} {\l__celtic_width_int-1}
{
  \int_step_inline:nnnn {-1} {2} {1} {
        \tl_clear_new:c {crossing used ##1 - ####1}
        \tl_set:cn {crossing used ##1 - ####1} {X}
    }
}
  }

  \IfBooleanTF {#1}
  {
    \int_set:Nn \l__celtic_flip_int {-1}
  }
  {
    \int_set:Nn \l__celtic_flip_int {1}
  }

  \int_step_inline:nnnn {1} {1} {\l__celtic_height_int-1}
  {
    \int_step_inline:nnnn {1 + \int_mod:nn {##1}{2}} {2} {\l__celtic_width_int-1}
{
    \celtic_generate_path:nnx {####1}{##1}{\int_eval:n {\l__celtic_flip_int*(2*\int_mod:nn{####1}{2} - 1)}}
    }
  }
  \celtic_render_path:n {#2}
}

\cs_new_nopar:Npn \celtic_generate_path:nnn #1#2#3
{
  \bool_if:nF {
    \tl_if_exist_p:c {crossing #1 - #2}
    ||
    \tl_if_empty_p:c {crossing used #1 - #2}
  }
  {
    \tl_clear:c {crossing used #1 - #2}
    \int_set:Nn \l__celtic_x {#1}
    \int_set:Nn \l__celtic_y {#2}
    \int_set_eq:NN \l__celtic_ox \l__celtic_x
    \int_set_eq:NN \l__celtic_oy \l__celtic_y
    \int_set:Nn \l__celtic_dx {#3}
    \int_set:Nn \l__celtic_dy {1}

    \int_zero:N \l__celtic_int
    \bool_do_until:nn
    {
      (\int_compare_p:n {\l__celtic_x == \l__celtic_ox}
      &&
      \int_compare_p:n {\l__celtic_y == \l__celtic_oy}
      )
      || \int_compare_p:n {\l__celtic_int > 20}
    }
    {
      \int_incr:N \l__celtic_int
      \celtic_next_crossing:
      \seq_put_left:NV \l__celtic_path_seq \l__celtic_path_tl
      \seq_put_left:NV \l__celtic_crossing_seq \l__celtic_crossing_tl
    }
  }
}

\cs_generate_variant:Nn \celtic_generate_path:nnn {nnx}

\cs_new_nopar:Npn \celtic_render_path:n #1
{

  \seq_map_inline:Nn \l__celtic_path_seq
  {
    \draw[#1] ##1;
  }

  \seq_map_inline:Nn \l__celtic_path_seq
  {
    \seq_pop:NN \l__celtic_crossing_seq \l__celtic_crossing_tl
    \pgfscope
    \clip \l__celtic_crossing_tl circle[radius=.7];
    \draw[#1,double~ background] ##1;
    \endpgfscope
    \pgfscope
    \clip \l__celtic_crossing_tl circle[radius=.71];
    \draw[#1,double~ foreground] ##1;
    \endpgfscope
  }
}


\ExplSyntaxOff


\makeatletter

\newif\if@celticclip
\tikzset{
  double background/.code={%
    \begingroup
    \tikz@double@setup
    \global\pgf@xa=\pgflinewidth
    \endgroup
    \expandafter\tikz@semiaddlinewidth\expandafter{\the\pgf@xa}%
    \tikz@addmode{\tikz@mode@doublefalse}%
  },
  double foreground/.code={%
    \begingroup
    \tikz@double@setup
    \global\pgf@xa=\pgfinnerlinewidth
    \endgroup
    \expandafter\tikz@semiaddlinewidth\expandafter{\the\pgf@xa}%
    \tikz@addmode{\tikz@mode@doublefalse}%
    \tikzset{color=\pgfinnerstrokecolor}%
  },
  celtic clip/.is if=@celticclip
}

\tikzset{
  celtic corner/.pic={
    \if@celticclip
    \begin{scope}
    \clip (1,2) circle[radius=.7];
    \draw[celtic/.try,pic actions,double background] (2,1) to[out=-135,in=0] (1,.5) -- (.5,.5) -- (.5,1)     to[out=90,in=-135] (1,2) -- (2,3);
    \end{scope}
    \begin{scope}
    \clip (1,2) circle[radius=.71];
    \draw[celtic/.try,pic actions,double foreground] (2,1) to[out=-135,in=0] (1,.5) -- (.5,.5) -- (.5,1)     to[out=90,in=-135] (1,2) -- (2,3);
    \end{scope}
    \else
    \draw[celtic bar/.try,pic actions] (0,2) -- (0,0) -- (2,0);
    \draw[celtic/.try,pic actions] (2,1) to[out=-135,in=0] (1,.5) -- (.5,.5) -- (.5,1) to[out=90,in=-135] (1,2) -- (2,3);
    \fi
  },
  celtic over corner/.pic={
    \if@celticclip
    \begin{scope}
    \clip (1,2) circle[radius=.7];
    \draw[celtic/.try,pic actions,double background] (2,1) to[out=-135,in=0] (1,.5) -- (.5,.5) -- (.5,1) to[out=90,in=-135] (1,2) arc[radius=sqrt(2),start angle=135,end angle=45];
    \end{scope}
    \begin{scope}
    \clip (1,2) circle[radius=.71];
    \draw[celtic/.try,pic actions,double foreground] (2,1) to[out=-135,in=0] (1,.5) -- (.5,.5) -- (.5,1) to[out=90,in=-135] (1,2) arc[radius=sqrt(2),start angle=135,end angle=45];
    \end{scope}
    \else
    \draw[celtic bar/.try,pic actions] (0,2) -- (0,0) -- (2,0) (1,3) -- (3,3);
    \draw[celtic/.try,pic actions] (2,1) to[out=-135,in=0] (1,.5) -- (.5,.5) -- (.5,1) to[out=90,in=-135] (1,2) arc[radius=sqrt(2),start angle=135,end angle=45];
    \fi
  },
  celtic curve/.pic={
    \if@celticclip
    \begin{scope}
    \clip (0,1) circle[radius=.7];
    \draw[celtic/.try,pic actions,double background] (2,1) to[out=-135,in=-45] (0,1) -- (-1,2);
    \end{scope}
    \begin{scope}
    \clip (0,1) circle[radius=.71];
    \draw[celtic/.try,pic actions,double foreground] (2,1) to[out=-135,in=-45] (0,1) -- (-1,2);
    \end{scope}
    \else
    \draw[celtic bar/.try,pic actions] (2,0) -- (0,0);
    \draw[celtic/.try,pic actions] (2,1) to[out=-135,in=-45] (0,1) -- (-1,2);
    \fi
  },
  celtic arc/.pic={
    \if@celticclip
    \begin{scope}
    \clip (0,1) circle[radius=.7];
    \draw[celtic/.try,pic actions,double background] (2,1) arc[start angle=-45, end angle=-225,radius=sqrt(2)] (0,3);
    \end{scope}
    \begin{scope}
    \clip (0,1) circle[radius=.71];
    \draw[celtic/.try,pic actions,double foreground] (2,1) arc[start angle=-45, end angle=-225,radius=sqrt(2)] (0,3);
    \end{scope}
    \else
    \draw[celtic bar/.try,pic actions] (2,0) -- (0,0) (-1,1) -- (-1,3);
    \draw[celtic/.try,pic actions] (2,1) arc[start angle=-45, end angle=-225,radius=sqrt(2)] (0,3);
    \fi
  },
  celtic line/.pic={
    \if@celticclip
    \begin{scope}
    \clip (1,1) circle[radius=.7];
    \draw[celtic/.try,pic actions,double background] (0,0) -- (2,2);
    \end{scope}
    \begin{scope}
    \clip (1,1) circle[radius=.71];
    \draw[celtic/.try,pic actions,double foreground] (0,0) -- (2,2);
    \end{scope}
    \else
    \draw[celtic/.try,pic actions] (0,0) -- (2,2);
    \fi
  },
}
\makeatother

\tikzset{
  celtic motif/.pic={
    \foreach \coord/\ang in {
      {(0,0)}/0,
      {(10,0)}/90,
      {(10,6)}/180,
      {(0,4)}/0%
    } {
      \pic[rotate=\ang] at \coord {celtic corner};
    }
    \pic[rotate=-90] at (0,4) {celtic over corner};
    \foreach \coord/\ang/\reflect in {
      {(2,0)}/0/1,%
      {(6,0)}/0/1,%
      {(3,5)}/90/-1,%
      {(3,3)}/-90/-1,%
      {(6,2)}/90/1,%
      {(5,5)}/180/-1,
      {(5,7)}/180/-1,
      {(4,6)}/180/1,
      {(6,4)}/-90/1,
      {(9,3)}/180/-1
    } {
      \pic[rotate=\ang,xscale=\reflect] at \coord {celtic curve};
    }
    \pic at (4,0) {celtic arc};
    \foreach \coord/\ang in {
      {(6,1)}/0,
      {(9,2)}/90,
      {(9,4)}/90
    } {
      \pic[rotate=\ang] at \coord {celtic line};
    }
  }
}

\begin{document}
\begin{tikzpicture}[
  scale=.5,
  celtic/.style={
    double=white,
    red,
    double distance=5pt,
    line width=1pt
  },
  celtic bar/.style={
    ultra thick,
    black,
    draw
  },
]
\CelticSetSize{20}{12}
\CelticSetSymmetricCrossing{10}{1}{|}
\CelticSetSymmetricCrossing{3}{2}{|}
\CelticSetSymmetricCrossing{3}{4}{|}
\CelticSetSymmetricCrossing{6}{3}{|}
\CelticSetSymmetricCrossing{10}{5}{|}
\CelticSetSymmetricCrossing{10}{3}{-}
\CelticSetSymmetricCrossing{9}{6}{-}
\CelticSetSymmetricCrossing{6}{5}{-}
\CelticSetSymmetricCrossing{3}{6}{-}
\CelticSetSymmetricCrossing{1}{4}{-}
\draw[gray!30,ultra thin] (0,0) grid (20,12);
\draw[ultra thick] (0,0) rectangle (20,12);
\foreach \x in {0,...,20}
\foreach \y in {0,...,12}
{
  \CelticCheckCrossing{\x}{\y}{
    \draw[celtic bar] (\x,\y-1) -- (\x,\y+1);
  }{
    \draw[celtic bar] (\x-1,\y) -- (\x+1,\y);
  }
}
\CelticDrawPath*[celtic]
\end{tikzpicture}


\begin{tikzpicture}[
  scale=.5,
  celtic/.style={
    double=white,
    red,
    double distance=5pt,
    line width=1pt
  },
  celtic bar/.style={
    ultra thick,
    black,
    draw
  },
]
\draw[help lines,step=1] (0,0) grid (20,12);
\pic[transform shape] {celtic motif};
\begin{scope}[celtic clip]
\pic[transform shape] {celtic motif};
\end{scope}
\end{tikzpicture}

\end{document}